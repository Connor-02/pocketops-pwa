<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PocketOps</title>
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#ffd6e7" />
    <link rel="stylesheet" href="/styles.css" />
</head>

<body>
    <div id="pinGate" class="overlay hidden">
        <div class="card modal">
            <h2>PocketOps PIN</h2>
            <div class="muted">Enter your 4-digit PIN to unlock this device.</div>
            <form id="pinUnlockForm" class="form">
                <input id="pinUnlockInput" class="input" inputmode="numeric" maxlength="4" pattern="\d{4}"
                    placeholder="0000" required />
                <button class="btn bigbtn" type="submit">Unlock</button>
            </form>
            <div id="pinUnlockError" class="muted danger hidden">Incorrect PIN.</div>
        </div>
    </div>

    <div id="onboarding" class="overlay hidden">
        <div class="card modal wide">
            <div class="card-h">
                <h2>Welcome to PocketOps</h2>
                <span class="pill" id="onboardStepLabel">Step 1 of 4</span>
            </div>
            <div id="onboardCopy" class="muted">Set your pay cycle and build your first zero-based plan.</div>

            <div class="onboard-step" data-step="1">
                <h3>Choose pay cycle</h3>
                <div class="chip-row">
                    <label class="chip"><input type="radio" name="payCycle" value="weekly"> Weekly</label>
                    <label class="chip"><input type="radio" name="payCycle" value="fortnightly" checked>
                        Fortnightly</label>
                    <label class="chip"><input type="radio" name="payCycle" value="monthly"> Monthly</label>
                </div>
            </div>

            <div class="onboard-step hidden" data-step="2">
                <h3>Add income</h3>
                <div class="form-row">
                    <label>Income per pay cycle</label>
                    <input id="obIncome" class="input" inputmode="decimal" placeholder="e.g. 1200.00" />
                </div>
                <div class="form-row">
                    <label>When did you last get paid?</label>
                    <input id="obPayday" class="input" type="date" />
                </div>
            </div>

            <div class="onboard-step hidden" data-step="3">
                <h3>Starter categories</h3>
                <div class="muted">Edit names if you want, then continue.</div>
                <div id="obCategories" class="listy"></div>
            </div>

            <div class="onboard-step hidden" data-step="4">
                <h3>Suggested starter budgets</h3>
                <div class="muted">Using your categories from step 3. Add budgets now or leave any field empty.</div>
                <div id="obSuggestedBudgets" class="listy"></div>
                <div class="hint">Use demo data adds sample budgets, transactions, and recurring bills so you can
                    explore quickly.</div>
            </div>

            <div class="row">
                <button id="obBack" class="btn ghost" type="button">Back</button>
                <div class="row right">
                    <button id="obDemo" class="btn ghost" type="button">Use demo data</button>
                    <button id="obNext" class="btn" type="button">Next</button>
                </div>
            </div>
        </div>
    </div>

    <header class="topbar">
        <div class="brand">
            <div class="logo">üê∞</div>
            <div>
                <div class="title">PocketOps</div>
                <div class="subtitle">Cute budgets ‚Ä¢ Ops worker vibe ‚Ä¢ Offline-first</div>
            </div>
        </div>
        <div class="top-actions">
            <span id="offlineBadge" class="pill">Offline-first: data stored locally</span>
            <button class="btn ghost" id="installBtn" hidden>Install</button>
            <button class="btn ghost" id="resetOnboardingBtn">Reset setup</button>
        </div>
    </header>

    <main class="wrap">
        <nav class="tabs">
            <button class="tab active" data-tab="dash">Dashboard</button>
            <button class="tab" data-tab="add">Add</button>
            <button class="tab" data-tab="budgets">Add Budgets</button>
            <button class="tab" data-tab="list">Transactions</button>
            <button class="tab" data-tab="insights">Insights / Alerts</button>
        </nav>

        <section class="panel tabpane" id="tab-dash">
            <div class="card soft explainer">
                <b>Concepts:</b> Unallocated is income not yet reserved. Projected estimates end-of-period spend pace.
            </div>
            <div class="card">
                <div class="seg-toggle" role="tablist" aria-label="Period">
                    <button id="dashPeriodWeekly" class="seg-btn active" type="button">Weekly</button>
                    <button id="dashPeriodMonthly" class="seg-btn" type="button">Monthly</button>
                </div>
                <div class="card-h">
                    <h2 id="periodTitle">This Week</h2>
                    <span id="periodRange" class="pill"></span>
                </div>

                <div class="hero-remaining">
                    <div class="k">Budgeted</div>
                    <div class="hero-v" id="periodRemain">$0.00</div>
                </div>

                <div class="meter">
                    <div class="meter-bar" id="periodBar"></div>
                </div>

                <div class="row period-secondary">
                    <div class="mini">
                        <div class="k">Spent</div>
                        <div class="v" id="periodSpent">$0.00</div>
                    </div>
                    <div class="mini">
                        <div class="k">Budget</div>
                        <div class="v" id="periodBudget">$0.00</div>
                    </div>
                    <div class="mini">
                        <div class="k">Unallocated</div>
                        <div class="v" id="periodUnalloc">$0.00</div>
                    </div>
                </div>

                <button id="periodDetailsToggle" class="btn ghost details-toggle" type="button"
                    aria-expanded="false">Show details ‚ñº</button>
                <div id="periodDetailsPanel" class="details-panel">
                    <div class="row period-secondary">
                        <div class="mini">
                            <div class="k">Income</div>
                            <div class="v" id="periodIncome">$0.00</div>
                        </div>
                        <div class="mini">
                            <div class="k">Net</div>
                            <div class="v" id="periodNet">$0.00</div>
                        </div>
                        <div class="mini">
                            <div class="k">Projected</div>
                            <div class="v" id="periodProj">$0.00</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card soft">
                <h3>Available to Spend</h3>
                <div class="row period-secondary">
                    <div class="mini">
                        <div class="k">Bills Reserved</div>
                        <div class="v" id="availableBills">$0.00</div>
                    </div>
                    <div class="mini">
                        <div class="k">Discretionary Available</div>
                        <div class="v hero-mini" id="availableDiscretionary">$0.00</div>
                    </div>
                </div>
            </div>

            <div id="alertsCard" class="card soft hidden">
                <h3>Alerts</h3>
                <div id="alerts" class="alerts"></div>
            </div>
        </section>

        <section class="panel tabpane hidden" id="tab-add">
            <div class="card">
                <div class="card-h">
                    <h2>Add Transaction</h2>
                    <span class="pill">Amount first</span>
                </div>
                <form id="txForm" class="form">
                    <div class="form-row">
                        <label>Amount</label>
                        <input id="txAmount" class="input" inputmode="decimal" placeholder="e.g. 12.50" autofocus
                            required />
                    </div>
                    <div class="form-row">
                        <label>Type</label>
                        <select id="txType" class="input">
                            <option value="expense" selected>Expense</option>
                            <option value="income">Income</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Merchant</label>
                        <input id="txMerchant" class="input" placeholder="e.g. Woolworths" required />
                    </div>
                    <div class="form-row">
                        <label>Category search</label>
                        <input id="txCategorySearch" class="input" placeholder="Search categories..." />
                        <div id="recentCats" class="chip-row"></div>
                    </div>
                    <div class="form-row">
                        <label>Category</label>
                        <select id="txCategory" class="input"></select>
                        <div class="row">
                            <button id="addCategoryBtn" class="btn ghost" type="button">Add category</button>
                            <button id="editCategoryBtn" class="btn ghost" type="button">Edit selected</button>
                            <button id="deleteCategoryBtn" class="btn ghost" type="button">Delete selected</button>
                        </div>
                    </div>
                    <div class="form-row">
                        <label>Date</label>
                        <input id="txDate" class="input" type="date" required />
                    </div>
                    <div class="form-row">
                        <label>Notes</label>
                        <input id="txNotes" class="input" placeholder="optional" />
                    </div>
                    <div class="split-box">
                        <label class="chip"><input id="txSplitToggle" type="checkbox" /> Split with housemates</label>
                        <div id="splitFields" class="hidden">
                            <div class="form-row">
                                <label>Split type</label>
                                <select id="txSplitType" class="input">
                                    <option value="i_paid">I paid</option>
                                    <option value="they_paid">They paid</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label>Split amount</label>
                                <input id="txSplitAmount" class="input" inputmode="decimal" placeholder="e.g. 15.00" />
                            </div>
                            <div class="form-row">
                                <label>Or split percentage</label>
                                <input id="txSplitPercent" class="input" inputmode="decimal" placeholder="e.g. 50" />
                            </div>
                        </div>
                    </div>
                    <button class="btn bigbtn" id="txSubmitBtn" type="submit">Add Transaction</button>
                </form>
            </div>
        </section>

        <section class="panel tabpane hidden" id="tab-budgets">
            <div class="card">
                <div class="card-h">
                    <h2>Add Budgets</h2>
                    <span class="muted">Reserve from Unallocated</span>
                </div>
                <div class="budget-head">
                    <div class="muted">Category</div>
                    <div class="muted">Per pay cycle</div>
                    <div class="muted">Reserve</div>
                </div>
                <div id="budgetList" class="budget-list"></div>
                <div class="row right">
                    <button class="btn" id="saveBudgetsBtn">Save Budgets</button>
                </div>
            </div>

            <div class="card">
                <div class="card-h">
                    <h2>Fixed Bills</h2>
                    <span class="muted">Recurring reserves</span>
                </div>
                <form id="billForm" class="grid2">
                    <input id="billName" class="input" placeholder="Bill name (Rent, Utilities...)" required />
                    <input id="billAmount" class="input" inputmode="decimal" placeholder="Amount" required />
                    <select id="billCycle" class="input">
                        <option value="weekly">Weekly</option>
                        <option value="fortnightly">Fortnightly</option>
                        <option value="monthly" selected>Monthly</option>
                    </select>
                    <select id="billCategory" class="input"></select>
                    <button class="btn" type="submit">Add Fixed Bill</button>
                </form>
                <div id="billList" class="listy"></div>
            </div>

        </section>

        <section class="panel tabpane hidden" id="tab-list">
            <div class="card">
                <div class="card-h">
                    <h2>Transactions</h2>
                    <div class="filters">
                        <input id="searchTx" class="input" placeholder="Search merchant / category..." />
                        <select id="rangeTx" class="input">
                            <option value="week" selected>This week</option>
                            <option value="month">This month</option>
                            <option value="all">All time</option>
                        </select>
                    </div>
                </div>
                <div id="txList" class="tx-list"></div>
            </div>

            <div class="grid2">
                <div class="card soft">
                    <h3>Split summary</h3>
                    <div id="splitsCard"></div>
                </div>
                <div class="card soft">
                    <h3>Spending coach</h3>
                    <div id="coachCard"></div>
                </div>
            </div>
        </section>

        <section class="panel tabpane hidden" id="tab-insights">
            <div class="grid2">
                <div class="card soft">
                    <h3>Subscription candidates</h3>
                    <div class="muted">Mark repeats as recurring bills.</div>
                    <div id="subs" class="listy"></div>
                </div>
                <div class="card soft">
                    <h3>Spend spikes</h3>
                    <div class="muted">This week vs 4-week average and top causes.</div>
                    <div id="spikes" class="listy"></div>
                </div>
            </div>

            <div class="card soft">
                <h3>Alerts</h3>
                <div id="insightAlerts" class="alerts"></div>
            </div>

            <div class="card soft">
                <h3>Export / Restore</h3>
                <div class="row">
                    <button class="btn" id="exportBtn">Export CSV</button>
                    <button class="btn" id="exportJsonBtn">Export JSON</button>
                    <label class="btn ghost" for="importJsonInput">Import JSON</label>
                    <input id="importJsonInput" type="file" accept="application/json" class="hidden" />
                </div>
                <div id="importStatus" class="muted"></div>
            </div>

            <div class="card soft">
                <h3>Local PIN lock</h3>
                <div class="muted">Stores only a local hash. If enabled, this device asks for PIN on app load.</div>
                <form id="pinForm" class="row">
                    <input id="pinInput" class="input" inputmode="numeric" maxlength="4" pattern="\d{4}"
                        placeholder="4-digit PIN" />
                    <button id="pinEnableBtn" class="btn" type="submit">Enable PIN</button>
                    <button id="pinDisableBtn" class="btn ghost" type="button">Disable PIN</button>
                </form>
            </div>
        </section>
    </main>

    <button id="quickAddBtn" class="quick-add">+</button>
    <div id="toast" class="toast hidden">
        <span id="toastMsg"></span>
        <button id="toastUndo" class="btn ghost">Undo</button>
    </div>

    <div id="categoryModal" class="overlay hidden">
        <div class="card modal">
            <h3 id="categoryModalTitle">Edit category</h3>
            <form id="categoryModalForm" class="form">
                <div class="form-row">
                    <label>Name</label>
                    <input id="categoryModalName" class="input" required />
                </div>
                <div class="form-row">
                    <label>Emoji</label>
                    <input id="categoryModalEmoji" class="input" maxlength="2" placeholder="‚ú®" />
                </div>
                <div class="row right">
                    <button id="categoryModalCancel" class="btn ghost" type="button">Cancel</button>
                    <button class="btn" type="submit">Save</button>
                </div>
            </form>
        </div>
    </div>

    <footer class="footer">
        <span class="muted">Offline-first ‚Ä¢ Data remains on this device by default.</span>
    </footer>

    <script type="module" src="/app.js"></script>
</body>

</html>